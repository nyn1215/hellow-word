(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-06f8ab7c"],{"1da1":function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));a("d3b7"),a("e6cf");function r(e,t,a,r,i,n,s){try{var o=e[n](s),c=o.value}catch(l){return void a(l)}o.done?t(c):Promise.resolve(c).then(r,i)}function i(e){return function(){var t=this,a=arguments;return new Promise((function(i,n){var s=e.apply(t,a);function o(e){r(s,i,n,o,c,"next",e)}function c(e){r(s,i,n,o,c,"throw",e)}o(void 0)}))}}},2909:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var r=a("6b75");function i(e){if(Array.isArray(e))return Object(r["a"])(e)}a("a4d3"),a("e01a"),a("d28b"),a("a630"),a("e260"),a("d3b7"),a("3ca3"),a("ddb0");function n(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}var s=a("06c5");function o(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(e){return i(e)||n(e)||Object(s["a"])(e)||o()}},a6bf:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-card",{attrs:{bordered:!1}},[a("div",{staticClass:"table-page-search-wrapper"},[a("a-form",{attrs:{layout:"inline",form:e.form},on:{submit:e.handleSubmit}},[a("a-row",{attrs:{gutter:48}},[a("a-col",{attrs:{md:5,sm:24}},[a("a-form-item",{attrs:{label:"动态名称"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["title",{rules:[{required:!1,message:"请输入动态名称"}]}],expression:"[\n              'title',\n              {rules: [{ required: false, message: '请输入动态名称' }]}\n            ]"}],attrs:{placeholder:"请输入动态名称"}})],1)],1),a("a-col",{attrs:{md:5,sm:24}},[a("a-form-item",{attrs:{label:"时间"}},[a("a-date-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:["noticeTime",{rules:[{required:!1,message:"请选择时间"}]}],expression:"['noticeTime', {rules: [{required: false, message: '请选择时间'}]}]"}],staticStyle:{width:"100%"},attrs:{format:"YYYY-MM-DD",placeholder:"请选择时间"}})],1)],1),a("a-col",{attrs:{md:5,sm:24}},[a("a-form-item",{attrs:{label:"类型"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["newsType",{rules:[{required:!1,message:"请选择类型"}]}],expression:"[ 'newsType', {rules: [{ required: false, message: '请选择类型' }]}]"}],attrs:{placeholder:"请选择类型"}},[a("a-select-option",{key:1,attrs:{value:"REPAIR"}},[e._v("报修")]),a("a-select-option",{key:2,attrs:{value:"PAY"}},[e._v("缴费")]),a("a-select-option",{key:3,attrs:{value:"SERVE"}},[e._v("服务")]),a("a-select-option",{key:4,attrs:{value:"ACTIVITY"}},[e._v("活动")])],1)],1)],1),a("a-col",{attrs:{md:4,sm:24}},[a("span",{staticClass:"table-page-search-submitButtons"},[a("a-button",{attrs:{type:"primary",htmlType:"submit"}},[e._v("搜索")]),a("a-button",{staticStyle:{"margin-left":"8px"},on:{click:e.handleReset}},[e._v("重置")])],1)])],1)],1)],1),a("div",{staticClass:"table-operator"},[a("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:function(t){return e.$refs.createModal.add()}}},[e._v("新增动态")])],1),a("a-table",{attrs:{loading:e.loading,columns:e.columns,pagination:e.pagination,rowKey:"id",dataSource:e.data},on:{change:e.handleTableChange},scopedSlots:e._u([{key:"avatar",fn:function(e){return a("span",{},[a("img",{style:{width:"80px",height:"80px"},attrs:{src:e,alt:""}})])}},{key:"action",fn:function(t){return a("span",{},[[a("a",{on:{click:function(a){return e.$refs.createModal.edit(t)}}},[e._v("修改")]),a("a-divider",{attrs:{type:"vertical"}}),a("a-popconfirm",{attrs:{title:"确定删除吗?"},on:{confirm:function(){return e.onDelete(t.id)}}},[a("a",{attrs:{href:"javascript:;"}},[e._v("删除")])])]],2)}}])}),a("dynamic-add",{ref:"createModal",on:{ok:e.handleOk}})],1)},i=[],n=a("5530"),s=(a("96cf"),a("1da1")),o=a("c1df"),c=a.n(o),l=a("365c"),u=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:e.title,width:800,visible:e.visible,confirmLoading:e.confirmLoading},on:{ok:e.handleSubmit,cancel:e.handleCancel}},[a("a-spin",{attrs:{spinning:e.confirmLoading}},[a("a-form",{attrs:{form:e.form}},[a("a-form-item",{attrs:{label:"名称","label-col":{span:3},"wrapper-col":{span:16}}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["title",{rules:[{required:!0,message:"请输入活动名称"}]}],expression:"['title', {rules: [{required: true, message: '请输入活动名称'}]}]"}],attrs:{placeholder:"请输入活动名称"}})],1),a("a-form-item",{attrs:{label:"消息类型","label-col":{span:3},"wrapper-col":{span:16}}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["newsType",{rules:[{required:!0,message:"请选择"}]}],expression:"[ 'newsType', {rules: [{ required: true, message: '请选择' }]}]"}],attrs:{placeholder:"请选择"}},[a("a-select-option",{key:1,attrs:{value:"REPAIR"}},[e._v("报修")]),a("a-select-option",{key:2,attrs:{value:"PAY"}},[e._v("缴费")]),a("a-select-option",{key:3,attrs:{value:"SERVE"}},[e._v("服务")]),a("a-select-option",{key:4,attrs:{value:"ACTIVITY"}},[e._v("活动")])],1)],1),a("a-form-item",{attrs:{label:"列表图","label-col":{span:3},"wrapper-col":{span:16}}},[a("div",{staticClass:"clearfix"},[a("a-upload",{attrs:{name:"file",action:e.UPLOAD_HOST,listType:"picture-card",fileList:e.videoList},on:{preview:e.handlePreview,change:e.videoChange}},[e.videoList.length<1?a("div",[a("a-icon",{attrs:{type:"plus"}}),a("div",{staticClass:"ant-upload-text"},[e._v("上传图片")])],1):e._e()])],1)]),a("a-form-item",{attrs:{label:"详情图","label-col":{span:3},"wrapper-col":{span:16}}},[a("div",{staticClass:"clearfix"},[a("a-upload",{attrs:{name:"file",action:e.UPLOAD_HOST,listType:"picture-card",fileList:e.fileList},on:{preview:e.handlePreview,change:e.handleChange}},[e.fileList.length<5?a("div",[a("a-icon",{attrs:{type:"plus"}}),a("div",{staticClass:"ant-upload-text"},[e._v("上传图片")])],1):e._e()])],1)]),a("a-form-item",{staticStyle:{height:"240px"},attrs:{label:"动态详情","label-col":{span:3},"wrapper-col":{span:20}}},[a("editor",{ref:"serviceContext",staticClass:"editor",attrs:{value:e.serviceContext}})],1),a("a-modal",{attrs:{visible:e.previewVisible,footer:null},on:{cancel:function(t){e.previewVisible=!1}}},[a("img",{staticStyle:{width:"100%"},attrs:{alt:"example",src:e.previewImage}})])],1)],1)],1)},d=[],m=(a("d81d"),a("d3b7"),a("ac1f"),a("25f0"),a("1276"),a("2909")),p=a("2af9"),f=a("da71"),v={components:{Editor:p["b"]},data:function(){return{UPLOAD_HOST:f["d"],moment:c.a,visible:!1,confirmLoading:!1,form:this.$form.createForm(this),title:null,videoList:[],fileList:[],previewVisible:!1,previewImage:null,record:{},id:null,serviceContext:"",defaultImg:"https://ss2.bdstatic.com/70cFvnSh_Q1YnxGkpoWK1HF6hhy/it/u=2889071587,4234702433&fm=26&gp=0.jpg"}},created:function(){},methods:{handleChange:function(e){var t=Object(m["a"])(e.fileList);t=t.map((function(e){return e.response&&(e.url=e.response.result.fileName),e})),this.fileList=t},videoChange:function(e){var t=Object(m["a"])(e.fileList);t=t.map((function(e){return e.response&&(e.url=e.response.result.fileName),e})),this.videoList=t},handlePreview:function(e){console.log(e),this.previewImage=e.url||e.thumbUrl,this.previewVisible=!0},add:function(){this.form.resetFields(),this.videoList=this.fileList=[],this.$refs.serviceContext&&(this.$refs.serviceContext.content=""),this.id=null,this.title="新增动态",this.visible=!0},edit:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.title="编辑动态",t.visible=!0,a.next=4,t.detailList(e.id);case 4:t.$nextTick((function(){t.id=t.record.id,t.videoList=t.record.imageUrl!=t.defaultImg?[t.record.imageUrl].map((function(e,t){return{uid:t,name:e,url:e}})):[],t.fileList=t.record.backgroundUrl!=t.defaultImg?t.record.backgroundUrl.split(",").map((function(e,t){return{uid:t,name:e,url:e}})):[],t.$refs.serviceContext.content="暂无动态详情"==t.record.context?"":t.record.context,t.form.setFieldsValue({title:t.record.title,newsType:t.record.newsType,context:t.record.context})}));case 5:case"end":return a.stop()}}),a)})))()},handleSubmit:function(){var e=this;this.confirmLoading=!0,this.form.validateFields((function(t,a){t?e.confirmLoading=!1:(a.imageUrl=""==e.videoList.map((function(e){return e.url})).toString()?e.defaultImg:e.videoList.map((function(e){return e.url})).toString(),a.backgroundUrl=""==e.fileList.map((function(e){return e.url})).toString()?e.defaultImg:e.fileList.map((function(e){return e.url})).toString(),a.context=""==e.$refs.serviceContext.content?"暂无动态详情":e.$refs.serviceContext.content,a=e.id?Object.assign({},a,{id:e.id}):a,setTimeout((function(){e.visible=!1,e.confirmLoading=!1,e.$emit("ok",a)}),1500))}))},handleCancel:function(){this.visible=!1},detailList:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var r,i,n,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(l["v"])({id:e});case 2:r=a.sent,i=r.result,n=r.httpCode,s=r.message,200===n?t.record=i:t.$message.error(s);case 7:case"end":return a.stop()}}),a)})))()}}},g=v,h=a("2877"),b=Object(h["a"])(g,u,d,!1,null,null,null),w=b.exports,y=[{title:"名称",key:"title",dataIndex:"title",align:"center"},{title:"缩略图",key:"imageUrl",dataIndex:"imageUrl",scopedSlots:{customRender:"avatar"},align:"center"},{title:"发布时间",key:"noticeTime",dataIndex:"noticeTime",align:"center"},{title:"类型",key:"newTypeName",dataIndex:"newTypeName",align:"center"},{title:"操作",key:"action",scopedSlots:{customRender:"action"},align:"center"}],x={current:1,defaultPageSize:5,total:0,pageSizeOptions:["5","10","50","100"],showSizeChanger:!0,showQuickJumper:!0},L={name:"ActivityList",components:{DynamicAdd:w},data:function(){return{form:this.$form.createForm(this),columns:y,data:[],pagination:x,selectedRowKeys:[],selectedRows:[],loading:!1,selectList:[]}},created:function(){this.typeList(),this.getList()},methods:{videoChange:function(){console.log(1)},handleOk:function(e){this.addList(e)},handleSubmit:function(e){var t=this;e.preventDefault(),this.form.validateFields((function(e,a){e||(a.activityTime&&(a.activityTime=c()(a.activityTime).format("YYYY-MM-DD")),t.pagination.current=1,t.getList(a))}))},handleTableChange:function(e){this.getList({pageIndex:e.current,pageSize:e.pageSize}),this.pagination.current=e.current,this.pagination.pageSize=e.pageSize,this.pagination.defaultPageSize=e.pageSize},handleReset:function(){this.form.resetFields(),this.getList()},onDelete:function(e){this.delList({id:e})},examineTap:function(e,t){this.updateList({id:e.id,activityState:t})},updateList:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var r,i,n,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(l["e"])(e);case 2:r=a.sent,i=r.result,n=r.httpCode,s=r.message,200===n?(t.getList(),t.$message.success(s),console.log(i)):t.$message.error(s);case 7:case"end":return a.stop()}}),a)})))()},addList:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var r,i,n,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(l["t"])(e);case 2:r=a.sent,i=r.result,n=r.httpCode,s=r.message,200===n?(t.getList(),t.$message.success(s),console.log(i)):t.$message.error(s);case 7:case"end":return a.stop()}}),a)})))()},delList:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var r,i,n,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(l["u"])(e);case 2:r=a.sent,i=r.result,n=r.httpCode,s=r.message,200===n?(t.getList(),t.$message.success(s),console.log(i)):t.$message.error(s);case 7:case"end":return a.stop()}}),a)})))()},typeList:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var a,r,i,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(l["f"])({});case 2:a=e.sent,r=a.result,i=a.httpCode,n=a.message,200===i?t.selectList=r:t.$message.error(n);case 7:case"end":return e.stop()}}),e)})))()},getList:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var r,i,s,o,c,u,d,m;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.loading=!0,r=t.pagination,i=r.current,s=r.defaultPageSize,o=Object.assign({},Object(n["a"])({pageIndex:i,pageSize:s},t.form.getFieldsValue()),e),a.next=5,Object(l["w"])(o);case 5:c=a.sent,u=c.result,d=c.httpCode,m=c.message,200===d?(t.data=u.list,t.pagination.total=u.totalSize):t.$message.error(m),t.loading=!1;case 11:case"end":return a.stop()}}),a)})))()}}},k=L,S=Object(h["a"])(k,r,i,!1,null,null,null);t["default"]=S.exports}}]);